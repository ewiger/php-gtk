LTLIBRARY_NAME          = libskeleton.la
LTLIBRARY_SOURCES       = php_skeleton.c gen_skeleton.c
LTLIBRARY_LIBADD        = $(SKELETON_SHARED_LIBADD)
LTLIBRARY_SHARED_NAME   = php_gtk_skeleton.la
LTLIBRARY_SHARED_LIBADD = $(SKELETON_SHARED_LIBADD)

include $(top_srcdir)/build/dynlib.mk

php_skeleton.o php_skeleton.lo php_skeleton.slo: gen_ce_skeleton.h

gen_skeleton.c: skeleton.defs skeleton.overrides
	$(PHP) -q $(top_srcdir)/generator/generator.php -o $(srcdir)/skeleton.overrides -p Skeleton -r $(top_srcdir)/ext/gtk%2b/gtk.defs $(srcdir)/skeleton.defs > gen_skeleton.c

gen_ce_skeleton.h: gen_skeleton.c
	grep -h "^PHP_GTK_EXPORT_CE" gen_skeleton.c | sed -e "s!^!extern !" > gen_ce_skeleton.h

