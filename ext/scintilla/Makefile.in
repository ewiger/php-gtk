LTLIBRARY_NAME          = libscintilla.la
LTLIBRARY_SOURCES       = php_scintilla.c gen_scintilla.c
LTLIBRARY_LIBADD        = $(SCINTILLA_SHARED_LIBADD)
LTLIBRARY_SHARED_NAME   = libscintilla.la
LTLIBRARY_SHARED_LIBADD = $(SCINTILLA_SHARED_LIBADD)

include $(top_srcdir)/build/dynlib.mk

php_scintilla.o php_scintilla.lo php_scintilla.slo: gen_ce_scintilla.h

gen_scintilla.c: scintilla.defs scintilla.overrides
	php -q $(top_srcdir)/generator/generator.php -o $(srcdir)/scintilla.overrides -p Scintilla -r $(top_srcdir)/ext/gtk%2b/gtk.defs $(srcdir)/scintilla.defs > gen_scintilla.c

gen_ce_scintilla.h: gen_scintilla.c
	grep -h "^PHP_GTK_EXPORT_CE" gen_scintilla.c | sed -e "s!^!extern !" > gen_ce_scintilla.h

