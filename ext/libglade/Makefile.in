LTLIBRARY_NAME          = liblibglade.la
LTLIBRARY_SOURCES       = php_libglade.c gen_libglade.c
LTLIBRARY_LIBADD        = $(LIBGLADE_SHARED_LIBADD)
LTLIBRARY_SHARED_NAME   = php_gtk_libglade.la
LTLIBRARY_SHARED_LIBADD = $(LIBGLADE_SHARED_LIBADD)

include $(top_srcdir)/build/dynlib.mk

php_libglade.o php_libglade.lo php_libglade.slo: gen_ce_libglade.h

gen_libglade.c: libglade.defs libglade.overrides
	$(PHP) -q $(top_srcdir)/generator/generator.php -o $(srcdir)/libglade.overrides -p libglade -r $(top_srcdir)/ext/gtk%2b/gtk.defs $(srcdir)/libglade.defs > gen_libglade.c

gen_ce_libglade.h: gen_libglade.c
	grep -h "^PHP_GTK_EXPORT_CE" gen_libglade.c | sed -e "s!^!extern !" > gen_ce_libglade.h

