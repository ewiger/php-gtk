LTLIBRARY_NAME          = libgtkhtml.la
LTLIBRARY_SOURCES       = php_gtkhtml.c gen_gtkhtml.c
LTLIBRARY_LIBADD        = $(HTML_SHARED_LIBADD)
LTLIBRARY_SHARED_NAME   = php_gtk_gtkhtml.la
LTLIBRARY_SHARED_LIBADD = $(HTML_SHARED_LIBADD)

include $(top_srcdir)/build/dynlib.mk

php_gtkhtml.o php_gtkhtml.lo php_gtkhtml.slo: gen_ce_gtkhtml.h

gen_gtkhtml.c: gtkhtml.defs gtkhtml.overrides
	php -q $(top_srcdir)/generator/generator.php -o $(srcdir)/gtkhtml.overrides -p gtkhtml  -r $(top_srcdir)/ext/gtk%2b/gtk.defs $(srcdir)/gtkhtml.defs > gen_gtkhtml.c

gen_ce_gtkhtml.h: gen_gtkhtml.c
	grep -h "^PHP_GTK_EXPORT_CE" gen_gtkhtml.c | sed -e "s!^!extern !" > gen_ce_gtkhtml.h

