LTLIBRARY_NAME          = libgdkpixbuf.la
LTLIBRARY_SOURCES       = php_gdkpixbuf.c gen_gdkpixbuf.c
LTLIBRARY_LIBADD        = $(GDK_PIXBUF_SHARED_LIBADD)
LTLIBRARY_SHARED_NAME   = php_gtk_gdkpixbuf.la
LTLIBRARY_SHARED_LIBADD = $(GDK_PIXBUF_SHARED_LIBADD)

include $(top_srcdir)/build/dynlib.mk

php_gdkpixbuf.o php_gdkpixbuf.lo php_gdkpixbuf.slo: gen_ce_gdkpixbuf.h

gen_gdkpixbuf.c: gdkpixbuf.defs gdkpixbuf.overrides
	$(PHP) -q $(top_srcdir)/generator/generator.php -o $(srcdir)/gdkpixbuf.overrides -p gdk_pixbuf -c GdkPixbuf -r $(top_srcdir)/ext/gtk%2b/gdk.defs $(srcdir)/gdkpixbuf.defs b> gen_gdkpixbuf.c

gen_ce_gdkpixbuf.h: gen_gdkpixbuf.c
	grep -h "^PHP_GTK_EXPORT_CE" gen_gdkpixbuf.c | sed -e "s!^!extern !" > gen_ce_gdkpixbuf.h

